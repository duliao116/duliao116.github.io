---
titile: 设计和实现如何保持一致
tags:
  - 质量
  - 项目管理
---
# 设计和实现如何保持一致

## 充分识别代码改动的影响
目前项目处于维护阶段，新增或修改的功能大多会影响到已有功能。那识别对已有功能的影响就是重中之重，对于代码改动的影响范围，可以设立影响范围评审，主要目的有三点：
1. 说明改动代码和影响范围之间的明确关系
2. 说明识别影响范围的方式方法——如何识别出影响范围的?是否合理?
3. 说明新增、改动代码为何如此改动，是否可以优化（而不是复制），是否影响范围最小?是否符合开闭原则?

## 逐步提交，逐步走查
涉及到大的版本变动，其对应的代码改动也会有很多，如果在所有代码编写完后统一进行代码走查，对应走查人员的压力很大，也不容易发现问题，为了避免这种情况，应当考虑分模块、分功能逐步提交代码。
1. 开发人员保证一次提交走查的代码对应一个完整模块或功能，走查通过后再提交下一个。
2. 提交走查的代码需要和设计文档保持一致。
3. 走查人员拒绝走查大批量、无规律的代码变动。

## 测试用例
1. 结合上一步的逐步提交，开发人员在提交某一个代码走查时，需要附上本次代码提交对应的测试用例及其执行结果（可以时单元测试、也可以是其它形式的测试用例），执行结果由开发人员自证。
2. 代码走查人员需要审核代码改动对应的测试用例是否合理，是否执行完整，执行方式是否合理。

## 框架层优化
本次出现的问题是由于查询对象没有设置默认查询条件（会员ID）引起的，对于这类情况，可以考虑在框架层面加入默认支持
1. 对于每个服务，设定其定制化的Query基类，避免开发人员由于复制、遗漏、覆盖等操作产生的严重问题。
@startuml
class Query
class FirmQuery
class CustomerQuery

Query <-- FirmQuery
Query <-- CustomerQuery
@enduml
```java
public class Query{

}

public classFirmQuery extend Query{
    //设置默认值，且不允许更改
    private String firmId = UserContext.getOrgId();
}

public classCustomerQuery extend Query{
    //设置默认值，且不允许更改
    private String customerId = UserContext.getCustomerId();
}
```
2. 减少代码复制，对于多个端的重复代码，考虑从架构层面进行优化，从而减少开发人员的复制问题。
